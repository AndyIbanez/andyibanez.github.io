<!doctype html><html prefix="og: http://ogp.me/ns#" lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,user-scalable=no"><meta http-equiv=x-ua-compatible content="ie=edge"><script async src="https://www.googletagmanager.com/gtag/js?id=G-CE7T69YX8Y"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-CE7T69YX8Y")}</script><link rel=apple-touch-icon sizes=180x180 href=https://www.andyibanez.com/favicons/apple-touch-icon-180x180.png><link rel=icon type=image/png sizes=32x32 href=https://www.andyibanez.com/favicons/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://www.andyibanez.com/favicons/favicon-16x16.png><link rel=manifest href=https://www.andyibanez.com/favicons/site.webmanifest><link rel=mask-icon href=https://www.andyibanez.com/favicons/safari-pinned-tab.svg color=#292148><meta name=msapplication-TileColor content="#292148"><meta name=msapplication-config content="https://www.andyibanez.com/favicons/browserconfig.xml"><meta name=theme-color content="#292148"><link rel=canonical href=https://www.andyibanez.com/posts/background-execution-in-ios/><link rel=alternate hreflang=en href=https://www.andyibanez.com/posts/background-execution-in-ios/ title><meta name=description content="Learn how to perform background tasks in your iOS App."><meta name=author content><meta name=theme-color content="#292148"><meta itemprop=name content="Background Execution on iOS"><meta itemprop=description content="Learn how to perform background tasks in your iOS App."><meta itemprop=datePublished content="2019-12-18T07:00:00-04:00"><meta itemprop=dateModified content="2019-12-18T07:00:00-04:00"><meta itemprop=wordCount content="2062"><meta itemprop=keywords content="swift,ios,ipados,iOS13"><meta property="og:url" content="https://www.andyibanez.com/posts/background-execution-in-ios/"><meta property="og:site_name" content="Andy Ibanez"><meta property="og:title" content="Background Execution on iOS"><meta property="og:description" content="Learn how to perform background tasks in your iOS App."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-12-18T07:00:00-04:00"><meta property="article:modified_time" content="2019-12-18T07:00:00-04:00"><meta property="article:tag" content="Swift"><meta property="article:tag" content="Programming"><meta property="article:tag" content="Apple"><meta property="article:tag" content="Ios"><meta property="article:tag" content="Ipados"><meta name=twitter:card content="summary"><meta name=twitter:title content="Background Execution on iOS"><meta name=twitter:description content="Learn how to perform background tasks in your iOS App."><meta name=twitter:creator content="@"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","url":"https://www.andyibanez.com/posts/background-execution-in-ios/","headline":"Background Execution on iOS","description":"Learn how to perform background tasks in your iOS App.","datePublished":"2019-12-18","keywords":"swift,programming,apple,ios,ipados","author":{"@type":"Person","name":""}}</script><title>Background Execution on iOS - Andy Ibanez</title><link rel=stylesheet href=https://www.andyibanez.com/style.main.min.18f604b90ed15864d7faa967f1ef9eacb99e1c967eff38762ec29b7bf1ab5876.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-CE7T69YX8Y"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-CE7T69YX8Y")}</script></head><body><div class=wrapper><nav><div class=container><div class=language-selector></div></div></nav><header><div class=container><div class=header-group><div class=header-logo-container><a class=header-logo-link href=https://www.andyibanez.com/><img class=header-logo-circle src=https://www.andyibanez.com/img/andy_profile.png alt="Andy Ibanez logo"></a></div><div class=header-title><a href=https://www.andyibanez.com/>Andy Ibanez</a></div></div></div></header><nav><div class=container><div class=main-navigation><a href=/about/>About Me</a><a href=/posts/>Blog</a><a href=/projects/>Projects</a><a href=/tags/>Tags</a><a href=/contact/>Contact</a><a href=/privacy-policy/>Privacy policy</a></div></div></nav><div class=container><div class=search><input type=text id=searchInput placeholder="Type here to search"></div><div class="container search-results-container" hidden=true><div id=searchResults class=search-results></div></div></div><main><div class=container><article><h1 class=title>Background Execution on iOS</h1><p class=publish>Published on
<time class=post-date datetime=2019-12-18T07:00:00-04:00>December 18, 2019</time></p><p>In the early days of iOS development, developers had no way at all to perform background tasks beyond a very limited constraints of tasks, like music playback. Modern demands go beyond allowing people to play music in your app while they use a different app, and we as developers need to adapt to these changes. VoIP, lengthy networking, and even silent pushes to keep an app updated are very common these days, and fulfilling these demands used to be hard, if not outright impossible.</p><p>iOS 7 was the first one to introduce more slightly powerful background execution APIs. In this article, we will explore how to perform background tasks in our apps and how to give our apps additional time to complete a task that was initially started in the foreground, and was later moved to the background before it had time to complete.</p><p>In particular, we will explore the following use cases.</p><ol><li>Getting additional background execution time when an app is sent to the background.</li><li>Starting background tasks with silent push notifications.</li><li>Deferred downloads with Discretionary Background URL Session.</li></ol><p>This article is based on the <a href=https://developer.apple.com/videos/play/wwdc2019/707>Advances in Background Execution</a> WWDC 2019 talk and in the documentation, but I have taken the liberty to add my own code examples and I have removed content that is not not relevant for the majority of developers (VoIP pushes, etc).</p><hr>**Note**<p>The original version of this article was supposed to cover the old background tasks APIs introduced since iOS 7 and then the new APIs introduced in iOS 13. The article became much longer than I had originally expected, so I separated the article into two different ones: One article for old but still relevant APIs (this one), and another one for the iOS 13 exclusive APIs (the <code>BackgroundTasks</code> framework).</p><p>For that reason this article won&rsquo;t cover the new shiny <code>BackgroundTasks</code>. You will have to wait until December 25 (Merry Christmas!) for that one. Sorry about that!</p><hr><h1 id=the-need-for-background-execution>The Need for Background Execution</h1><h2 id=what-exactly-is-background-execution>What exactly is background execution?</h2><p>Background execution is simply letting the app run code while it&rsquo;s not in the foreground - it&rsquo;s not the app the user is currently using.</p><p>The app can require background execution if it requests it to the system. If you want to refresh content and have an up-to-date UI for your users when they relaunch your app after a few hours. Chat applications may want to do this, so next time the user launches an app, they can see all their chats updated instead of waiting for the app to do it when they visit the app. The app can also request this to complete some work that started while the app was in the background, like a big network download.</p><p>The app can also begin background execution when an event takes place in the system. For example, it can be triggered when the user receives a notification, or when the GPS detects the device is in a specific location. In other words, the data needs to respond to some event.</p><h2 id=considerations>Considerations</h2><p>The background execution system still has some considerations that you should really keep in mind before you go forward with this.</p><p>First is <em>power</em>. If your app uses too much battery performing background execution, it may be a bad experience for your user. You should let the system know when your tasks finish to become a good player in the Background Execution world. If you allocate 60 seconds for a task and finish it in 40, let the system know and it will become more generous with your requests over time.</p><p>The second is <em>performance</em>. Multiple apps may be running in the background at a time, and then there&rsquo;s the little bonus that a foreground may also be executing. Be aware that your app is not the only app in your user&rsquo;s devices, and they may have thousands of different apps performing background tasks.</p><p>Finally, there&rsquo;s <em>privacy</em>. You cannot view other background tasks, as it is expected in the Apple fashion.</p><p>You should adopt background execution keeping all these in factors in mind.</p><h1 id=background-execution-use-cases>Background Execution Use Cases</h1><hr>**Note**<p>Like I said above, the original article was supposed to cover both the old and new APIs for background execution. Everything written here is stuff that can be done pre-iOS 13.</p><hr><p>We can divide the use cases of background execution into different categories. If your app needs to do any of the following, you can adopt this new framework:</p><ul><li>Give additional time to execute a task before the app is suspended. If you start work in the foreground, you can complete it in the background.</li><li>Triggering background tasks with silent push notifications.</li><li>Downloading content at a later time with Background URL Session.</li></ul><p>We will go through each individually, offering code whenever possible.</p><h2 id=give-additional-time-to-execute-a-task-before-being-suspended>Give additional time to execute a task before being suspended.</h2><p><code>UIApplication</code> has a simple method that can be used for this: <a href=https://developer.apple.com/documentation/uikit/uiapplication/1623031-beginbackgroundtask>beginBackgroundTask(expirationHandler:)</a></p><pre tabindex=0><code>UIApplication.beginBackgroundTask(expirationHandler:)
</code></pre><p>You should call this method when leaving a task unfinished may cause a bad user experience in your app. You can use it to complete disk writes, finish user-initiated requests, network calls, and tasks similar to that. The <code>expirationHandler</code> is optional, but if you provide it the system will call it before the time expires to give you a chance to end a task gracefully before it had time to complete.</p><p>You should call this method right before you start your task, and better if you do before the app actually enters the background state.</p><p>Each call to this API should have a matching call to <a href=https://developer.apple.com/documentation/uikit/uiapplication/1622970-endbackgroundtask><code>UIApplication.endBackgroundTask(identifier:)</code></a>. Because apps cannot run indefinitely in the background, you can check how much time your app has by checking the <code>backgroundTimeRemaining</code> property of <code>UIApplication</code>.</p><p>You can call <code>beginBackgroundTask</code> any time, and as many times as you want. Each call will return a unique <code>identifier</code> you can use to identify a task, or <code>"invalid"</code> if the app doesn&rsquo;t support background execution. Don&rsquo;t forget to end your tasks by calling <code>endBackgroundTask</code> with the identifier returned by <code>beginBackgroundTasks</code>.</p><p>You can get your hands dirty with this. Create a new empty project and put this code inside <code>viewDidAppear</code> in the default view controller:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>taskId</span> = UIApplication.shared.beginBackgroundTask {
</span></span><span style=display:flex><span>      <span style=color:#89dceb>print</span>(<span style=color:#a6e3a1>&#34;We are about to kill your task&#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#89dceb>print</span>(<span style=color:#a6e3a1>&#34;The task ID: </span><span style=color:#a6e3a1>\(</span>taskId<span style=color:#a6e3a1>)</span><span style=color:#a6e3a1>&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>_</span> = Timer.scheduledTimer(withTimeInterval: <span style=color:#fab387>1</span>, repeats: <span style=color:#fab387>true</span>) { <span style=color:#fab387>_</span> <span style=color:#cba6f7>in</span>
</span></span><span style=display:flex><span>      <span style=color:#89dceb>print</span>(<span style=color:#a6e3a1>&#34;Executing (</span><span style=color:#a6e3a1>\(</span>UIApplication.shared.backgroundTimeRemaining<span style=color:#a6e3a1>)</span><span style=color:#a6e3a1> seconds remaining)&#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p>In my tests, while this was running in the foreground, it kept printing <code>Executing (1.7976931348623157e+308 seconds remaining)</code>. As soon as I backgrounded it, I saw that the system allocated approximately 30 seconds for the background task:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>Executing (29.899623215998872 seconds remaining)
</span></span><span style=display:flex><span>Executing (28.80678400799661 seconds remaining)
</span></span><span style=display:flex><span>Executing (27.900681052997243 seconds remaining)
</span></span><span style=display:flex><span>Executing (26.9005714599989 seconds remaining)
</span></span><span style=display:flex><span>Executing (25.804284562997054 seconds remaining)
</span></span><span style=display:flex><span>Executing (24.80326834999869 seconds remaining)
</span></span><span style=display:flex><span>Executing (23.802226524996513 seconds remaining)
</span></span><span style=display:flex><span>Executing (22.801737096997385 seconds remaining)
</span></span><span style=display:flex><span>Executing (21.900720710000314 seconds remaining)
</span></span><span style=display:flex><span>Executing (20.900698297002236 seconds remaining)
</span></span><span style=display:flex><span>Executing (19.900725225001224 seconds remaining)
</span></span><span style=display:flex><span>Executing (18.900687380999443 seconds remaining)
</span></span><span style=display:flex><span>Executing (17.90067362899572 seconds remaining)
</span></span><span style=display:flex><span>Executing (16.900717349999468 seconds remaining)
</span></span><span style=display:flex><span>Executing (15.853402848995756 seconds remaining)
</span></span><span style=display:flex><span>Executing (14.8417572249964 seconds remaining)
</span></span><span style=display:flex><span>Executing (13.82555943299667 seconds remaining)
</span></span><span style=display:flex><span>Executing (12.816451088998292 seconds remaining)
</span></span><span style=display:flex><span>Executing (11.900728770000569 seconds remaining)
</span></span><span style=display:flex><span>Executing (10.900756258997717 seconds remaining)
</span></span><span style=display:flex><span>Executing (9.816338092998194 seconds remaining)
</span></span><span style=display:flex><span>Executing (8.814374344001408 seconds remaining)
</span></span><span style=display:flex><span>Executing (7.805837875996076 seconds remaining)
</span></span><span style=display:flex><span>Executing (6.803114914997423 seconds remaining)
</span></span><span style=display:flex><span>Executing (5.816280047998589 seconds remaining)
</span></span><span style=display:flex><span>We are about to kill your task
</span></span><span style=display:flex><span>Executing (4.802873692999128 seconds remaining)
</span></span><span style=display:flex><span>Executing (3.8997083849972114 seconds remaining)
</span></span><span style=display:flex><span>Executing (2.899573540998972 seconds remaining)
</span></span><span style=display:flex><span>Executing (1.8968817720015068 seconds remaining)
</span></span><span style=display:flex><span>Executing (0.8995601319984416 seconds remaining)
</span></span><span style=display:flex><span>Executing (0.0 seconds remaining)
</span></span></code></pre></div><p>In my tests, the expiration handler got called about 5 seconds before the time expired.</p><p>It&rsquo;s possible the system adjusts this automatically depending on how good of a player you are and how you use background tasks.</p><hr><p><strong>Important Note!</strong></p><p>While my tests say you get around 30 seconds for execution task and the completion handler gets called about 5 seconds before the task expires, you should not rely on these numbers in your app. Don&rsquo;t hard code anything. As a rule of thumb, just try to finish all your work as soon as possible when using <code>beginBackgroundTask</code>, because if the system doesn&rsquo;t adjust to your use case, future iOS versions may change the amount of time you get for executing tasks.</p><hr><p>Of course we want to be good background execution citizens, so we should end the task at some point. For now, we will end the task when we only have 10 or less seconds left.</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>_</span> = Timer.scheduledTimer(withTimeInterval: <span style=color:#fab387>1</span>, repeats: <span style=color:#fab387>true</span>) { <span style=color:#fab387>_</span> <span style=color:#cba6f7>in</span>
</span></span><span style=display:flex><span>      <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>bgTimeLeft</span> = UIApplication.shared.backgroundTimeRemaining
</span></span><span style=display:flex><span>      <span style=color:#89dceb>print</span>(<span style=color:#a6e3a1>&#34;Executing (</span><span style=color:#a6e3a1>\(</span>bgTimeLeft<span style=color:#a6e3a1>)</span><span style=color:#a6e3a1> seconds remaining)&#34;</span>)
</span></span><span style=display:flex><span>      <span style=color:#cba6f7>if</span> bgTimeLeft <span style=color:#89dceb;font-weight:700>&lt;=</span> <span style=color:#fab387>10</span> {
</span></span><span style=display:flex><span>        UIApplication.shared.endBackgroundTask(taskId)
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p>If you background the app, the app will not print anything else after the available execution time is less than 10. In other words, your expiration handler will not get called when you end the task properly with a few seconds to spare.</p><p>For reference, here&rsquo;s the whole code I wrote for <code>viewDidAppear</code>:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>  <span style=color:#cba6f7>override</span> <span style=color:#f38ba8>func</span> <span style=color:#89b4fa>viewDidAppear</span>(<span style=color:#fab387>_</span> animated: <span style=color:#89dceb>Bool</span>) {
</span></span><span style=display:flex><span>    <span style=color:#fab387>super</span>.viewDidAppear(<span style=color:#fab387>true</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>taskId</span> = UIApplication.shared.beginBackgroundTask {
</span></span><span style=display:flex><span>      <span style=color:#89dceb>print</span>(<span style=color:#a6e3a1>&#34;We are about to kill your task&#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#89dceb>print</span>(<span style=color:#a6e3a1>&#34;The task ID: </span><span style=color:#a6e3a1>\(</span>taskId<span style=color:#a6e3a1>)</span><span style=color:#a6e3a1>&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>_</span> = Timer.scheduledTimer(withTimeInterval: <span style=color:#fab387>1</span>, repeats: <span style=color:#fab387>true</span>) { <span style=color:#fab387>_</span> <span style=color:#cba6f7>in</span>
</span></span><span style=display:flex><span>      <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>bgTimeLeft</span> = UIApplication.shared.backgroundTimeRemaining
</span></span><span style=display:flex><span>      <span style=color:#89dceb>print</span>(<span style=color:#a6e3a1>&#34;Executing (</span><span style=color:#a6e3a1>\(</span>bgTimeLeft<span style=color:#a6e3a1>)</span><span style=color:#a6e3a1> seconds remaining)&#34;</span>)
</span></span><span style=display:flex><span>      <span style=color:#cba6f7>if</span> bgTimeLeft <span style=color:#89dceb;font-weight:700>&lt;=</span> <span style=color:#fab387>10</span> {
</span></span><span style=display:flex><span>        UIApplication.shared.endBackgroundTask(taskId)
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div><h3 id=giving-additional-time-to-extensions>Giving additional time to extensions.</h3><p>You can also give extensions additional time before they get suspended by the system, with the following method:</p><pre tabindex=0><code>ProcessInfo().performExpiringActivity(withReason:using:)
</code></pre><p>The first parameter is a string you can use for debugging purposes. The second parameter is a handler where you put code you want to execute in the background. The block will give you a boolean telling you if the process is about to be suspended. If the boolean is <code>true</code>, you should take caution to end the task as soon as possible. I wasn&rsquo;t able to find a way to tell how much time you have left to execute a background task with this API.</p><p>The system will define if it can execute your handler at all. If it can&rsquo;t, it will call it passing it <code>true</code>, forcing you finish everything as soon as possible. If it can execute your task, it will call the handler with <code>false</code>.</p><p>If the system is executing the handler and needs to suspend it, it will call your handler a second time passing <code>true</code>, so keep in mind that this handler might be called more than once. A rule of thumb is to simply cancel anything your handler is doing when the parameter is <code>true</code>.</p><h2 id=triggering-background-execution-with-notifications>Triggering Background Execution with Notifications</h2><p>Background Pushes are a mechanism to tell devices that new data is available without notifying the user. In other words, they don&rsquo;t display any kind of UI or play a sound.</p><p>To send a silent push, add the <code>content-available</code> key to <code>1</code>, and don&rsquo;t include <code>badge</code>, <code>sound</code>, or <code>alert</code>. You must also set <code>apns-priority</code> to <code>5</code> and it is highly recommended, but necessary on to watchOS, to set <code>apns-push-type</code> to <code>background</code>,</p><p>The push will not trigger the download immediately. Instead, the system will intelligently decide the best time to download new content, including factors such as power and performance.</p><h2 id=download-content-at-a-later-time-with-discretionary-background-url-session>Download Content at a Later Time with Discretionary Background URL Session.</h2><p>This is a way to tell the system to defer downloads until a better time. We can provide information to the system for smarter scheduling.</p><p>Using it is as easy as any other <code>URLSession</code>, but starting on iOS 13, you can set the <code>isDiscretionary</code> property to <code>true</code>.</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>config</span> = URLSessionConfiguration.background(withIdentifier: <span style=color:#a6e3a1>&#34;com.andyibanez.pastContent&#34;</span>)
</span></span><span style=display:flex><span>config.isDiscretionary = <span style=color:#fab387>true</span>
</span></span><span style=display:flex><span><span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>session</span> = URLSession(configuration: config)
</span></span></code></pre></div><p>The advantage of this API is that you have finer control over the session, as you can set intervals, the earliest begin date, and more.</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>config.timeoutIntervalForResource = <span style=color:#fab387>24</span> <span style=color:#89dceb;font-weight:700>*</span> <span style=color:#fab387>60</span> <span style=color:#89dceb;font-weight:700>*</span> <span style=color:#fab387>60</span>   config.timeoutIntervalForRequest = <span style=color:#fab387>60</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#f38ba8>var</span> <span style=color:#f5e0dc>request</span> = URLRequest(url: URL(string: <span style=color:#a6e3a1>&#34;google.com&#34;</span>)<span style=color:#89dceb;font-weight:700>!</span>)
</span></span><span style=display:flex><span>request.addValue(<span style=color:#a6e3a1>&#34;foo&#34;</span>, forHTTPHeaderField: <span style=color:#a6e3a1>&#34;bar&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>task</span> = session.downloadTask(with: request)
</span></span><span style=display:flex><span>task.earliestBeginDate = Date(timeIntervalSinceNow: <span style=color:#fab387>2</span> <span style=color:#89dceb;font-weight:700>*</span> <span style=color:#fab387>60</span> <span style=color:#89dceb;font-weight:700>*</span> <span style=color:#fab387>60</span>)
</span></span></code></pre></div><h1 id=conclusion>Conclusion</h1><p>Background execution is a very common task and you can adopt your app to do it. Prior to iOS 13, you could follow three use cases to implement it in your own code:</p><ol><li>Give extra time to a task to finish after it enters the background.</li><li>Start background tasks upon receiving silent push notifications.</li><li>Defer long downloads to a discretionary background URL session.</li></ol><p>The APIs are easy to use, and I encourage you to add them if it makes sense in your use case. In particular, the first point is very useful as you never know when a user may send your app to the background when your app is doing something important.</p></article></div></main><footer><div class=container><div class=footer-navigation><a href=https://github.com/AndyIbanez><span class=inline-svg><svg viewBox="0 0 42 40" id="svg4" width="42" height="40"><path fill="currentColor" d="m14.20936 32.20794c0 .16542-.19024.29776-.4301.29776-.27295.0248-.46319-.10752-.46319-.29776.0-.16542.19024-.29776.4301-.29776.24814-.0248.46319.10752.46319.29776zm-2.57234-.3722c-.0579.16542.10753.35566.35566.40528.21505.0827.46319.0.51282-.16542.0496-.16542-.10753-.35566-.35566-.4301-.21505-.0579-.45492.0248-.51282.19024zm3.65586-.14061c-.23986.0579-.40529.21505-.38047.40528.0248.16543.23986.27295.488.21505.23986-.0579.40528-.21505.38047-.38047-.0248-.15715-.24813-.26468-.488-.23986zM20.73531-.19734273e-6C9.2632-.19734273e-6.48748 8.7095398.48748 20.18166c0 9.17273 5.77328 17.02207 14.01964 19.78464 1.05871.19024 1.43091-.46319 1.43091-1.00081.0-.51282-.0248-3.34156-.0248-5.0785.0.0-5.78982 1.24067-7.00568-2.46481.0.0-.94292-2.40691-2.29939-3.02725.0.0-1.8941-1.29857.13234-1.27376.0.0 2.05952.16542 3.19267 2.13396 1.81139 3.19267 4.84691 2.27457 6.02969 1.72868.19023-1.32339.72786-2.24149 1.32338-2.78739-4.62358-.51281-9.28852-1.18278-9.28852-9.13964.0-2.27458.62861-3.416 1.95199-4.87172-.21505-.53763-.9181-2.7543.21506-5.6161302 1.72867-.53762 5.7071 2.2332202 5.7071 2.2332202 1.65424-.46319 3.43254-.70305 5.1943-.70305 1.76176.0 3.54006.23986 5.1943.70305.0.0 3.97843-2.7791202 5.7071-2.2332202 1.13315 2.8701002.4301 5.0785002.21505 5.6161302 1.32339 1.46399 2.13397 2.60542 2.13397 4.87172.0 7.98168-4.87172 8.61856-9.49531 9.13964.76095.65342 1.4061 1.8941 1.4061 3.83782.0 2.78739-.0248 6.23647-.0248 6.9147.0.53763.38047 1.19105 1.43091 1.00082 8.27117-2.74603 13.87903-10.59537 13.87903-19.7681C41.51252 8.7095398 32.20745-.19734273e-6 20.73533-.19734273e-6zM8.52706 28.52727c-.10752.0827-.0827.27295.0579.4301.13234.13234.32258.19024.4301.0827.10753-.0827.0827-.27295-.0579-.4301-.13233-.13234-.32257-.19024-.4301-.0827zM7.63378 27.8573c-.0579.10753.0248.23987.19023.32258.13234.0827.29777.0579.35566-.0579C8.23757 28.01446 8.15487 27.88212 7.98944 27.7994 7.82401 27.7498 7.69168 27.7746 7.63378 27.8573zm2.67986 2.94454c-.13234.10753-.0827.35566.10752.51281.19024.19024.4301.21505.53763.0827.10752-.10752.0579-.35566-.10753-.51281-.18196-.19024-.4301-.21505-.53762-.0827zM9.37072 29.58598c-.13234.0827-.13234.29776.0.488.13234.19023.35566.27295.46319.19023.13234-.10752.13234-.32257.0-.51281-.1158-.19024-.33085-.27295-.46319-.16542z" id="path2" style="stroke-width:.08271171"/></svg>
</span></a><a href=https://x.com/AndyIbanezK><span class=inline-svg><svg viewBox="0 0 50 40" id="svg4" width="50" height="40"><path fill="currentColor" d="m44.56253 9.96871c.0313.43748.0313.87506.0313 1.31254C44.59383 24.62494 34.43764 40 15.87508 40 10.1563 40 4.84383 38.34368.37506 35.4688c.81253.0937 1.5937.12495 2.4375.12495 4.71867.0 9.06249-1.5937 12.53125-4.31245-4.43751-.0938-8.15627-3.00003-9.43754-7.00006.62505.0937 1.25001.15622 1.90632.15622.90622.0 1.81254-.12505 2.65624-.34369C5.84384 23.15619 2.37498 19.09373 2.37498 14.18748v-.12495c1.3437.75 2.90633 1.21875 4.56246 1.28117-2.71876-1.81253-4.49993-4.90624-4.49993-8.40627.0-1.87497.4999-3.59372 1.37496-5.09373 4.96877 6.125 12.43756 10.12493 20.81248 10.56251-.15622-.75001-.25-1.53118-.25-2.31245C24.37495 4.5312 28.87498.0 34.46871.0c2.90623.0 5.53121 1.21875 7.37501 3.1875 2.28118-.43748 4.46867-1.28127 6.40626-2.43749-.75011 2.3438-2.34381 4.31255-4.43751 5.56246 2.03127-.21864 4.00003-.78126 5.81247-1.56244-1.37477 1.99992-3.09362 3.7811-5.06237 5.21868z" id="path2" style="stroke-width:.09619153"/></svg>
</span></a><a href=https://www.linkedin.com/in/andyibanez/><span class=inline-svg><svg viewBox="0 0 41 40" id="svg4" width="41" height="40"><path fill="currentColor" d="M9.45332 40H1.16028V13.29405H9.45332zM5.30234 9.65111c-2.65185.0-4.80279-2.19648-4.80279-4.84832a4.80279 4.80279.0 019.60558.0c0 2.65184-2.15184 4.84832-4.80279 4.84832zM40.49152 40H32.21633V26.99971c0-3.09828-.0625-7.07159-4.3117-7.07159-4.3117.0-4.97243 3.36615-4.97243 6.84837V40H14.64808V13.29405h7.95375v3.64294h.11608c1.10716-2.09827 3.81169-4.3126 7.8466-4.3126 8.39304.0 9.93594 5.52691 9.93594 12.70564V40z" id="path2" style="stroke-width:.08928771"/></svg>
</span></a><a href=https://www.andyibanez.com/posts/index.xml><span class=inline-svg><svg viewBox="0 0 40 40" id="svg4" width="40" height="40"><path fill="currentColor" d="m11.435816 34.282008c0 3.15793-2.5599899 5.71793-5.7179299 5.71793s-5.717840022654-2.56-5.717840022654-5.71793c0-3.15794 2.559990022654-5.71793 5.717930022654-5.71793s5.7178399 2.56008 5.7178399 5.71793zm15.68388 4.21873C26.373806 24.697208 15.317496 13.626978 1.4992361 12.880288.68361608 12.836188.46077346e-4 13.491538.46077346e-4 14.308318v4.29186c0 .75134.579460002654 1.38142 1.329190022654 1.43017 9.9849699.65036 17.9886099 8.63408 18.6402999 18.6403.0488.74973.67893 1.3292 1.43018 1.3292h4.29186c.81687 9e-5 1.47223-.68348 1.42812-1.49911zm12.87933.0257C39.249566 17.649718 22.452206.754048 1.4735261.00092799867.66727608-.027972.46077346e-4.623338.46077346e-4 1.430038v4.29177c0 .77008.610270002654 1.39687 1.379730022654 1.42848 17.0694999.6999 30.7701699 14.40316 31.4699899 31.46999.0315.76946.6583 1.37972 1.42848 1.37972h4.29177c.8066-8e-5 1.45794-.66731 1.42901-1.47356z" id="path2" style="stroke-width:.08928544"/></svg>
</span></a><a href=https://www.andyibanez.com/contact><span class=inline-svg><svg viewBox="0 0 40 40" id="svg4" width="40" height="40"><path fill="currentColor" d="m39.99999 36.249999c0 2.0711-1.6789 3.75-3.74999 3.75H3.75c-2.07109.0-3.74999-1.6789-3.74999-3.75v-20.56843a3.7499996 3.7499996.0 011.43648-2.95125c1.94633-1.5257 3.55476-2.7628904 12.82812-9.4930404C15.57906 2.2789186 18.18727-.02709136 20 .00024864227 21.81234-.02745136 24.42156 2.2793086 25.73539 3.2371986c9.27242 6.72945 10.88304 7.9683604 12.82812 9.4931204a3.7499996 3.7499996.0 011.43648 2.95125zm-5.13015-15.35976c-.20024-.29125-.60156-.35898-.88586-.14898-1.78476 1.3182-4.33297 3.18008-8.24859 6.02179-1.31445.95828-3.92266 3.26414-5.73539 3.23672-1.81336.0269-4.41867-2.2768-5.73539-3.23672-3.91515-2.8414-6.46359-4.70343-8.24859-6.02179-.2843-.21-.68562-.14227-.88586.14898l-.70875 1.03094a.62484368.62484368.0 00.14367.8568c1.78805 1.32023 4.33235 3.1789 8.2268 6.00531 1.5839 1.15476 4.41593 3.73539 7.20812 3.71664 2.79094.0189 5.62195-2.56024 7.20804-3.71664 3.89453-2.82649 6.43891-4.68516 8.2268-6.00531a.62484368.62484368.0 00.14367-.8568z" id="path2" style="stroke-width:.07812498"/></svg></span></a></div></div><p class=made-with-love><a href=https://github.com/humrochagf/colordrop><b>Colordrop</b>
</a><span>theme | Made </span><span>by</span>
<a href=https://humberto.io/><b>Humberto Rocha</b></a></p></footer></div><script src=/copy/copy.js></script><script src=/search/elasticlunr.min.js></script><script src=/search/search.js></script><script>loadSearch("https://www.andyibanez.com/index.json")</script></body></html>