<!doctype html><html prefix="og: http://ogp.me/ns#" lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,user-scalable=no"><meta http-equiv=x-ua-compatible content="ie=edge"><script async src="https://www.googletagmanager.com/gtag/js?id=G-CE7T69YX8Y"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-CE7T69YX8Y")}</script><link rel=icon type=image/png href=https://www.andyibanez.com/img/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://www.andyibanez.com/img/favicon-16x16.png sizes=16x16><link rel=canonical href=https://www.andyibanez.com/posts/understanding-function-builders/><link rel=alternate hreflang=en href=https://www.andyibanez.com/posts/understanding-function-builders/ title><meta name=description content="Learn what Function Builders in Swift are, and how to use them"><meta name=author content><meta name=theme-color content="#292148"><meta itemprop=name content="Understanding Function Builders in Swift"><meta itemprop=description content="Learn what Function Builders in Swift are, and how to use them"><meta itemprop=datePublished content="2020-03-11T07:00:00-04:00"><meta itemprop=dateModified content="2020-03-11T07:00:00-04:00"><meta itemprop=wordCount content="1607"><meta itemprop=keywords content="swift,programming,apple,function builders,wwdc2019"><meta property="og:url" content="https://www.andyibanez.com/posts/understanding-function-builders/"><meta property="og:site_name" content="Andy Ibanez"><meta property="og:title" content="Understanding Function Builders in Swift"><meta property="og:description" content="Learn what Function Builders in Swift are, and how to use them"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-03-11T07:00:00-04:00"><meta property="article:modified_time" content="2020-03-11T07:00:00-04:00"><meta property="article:tag" content="Swift"><meta property="article:tag" content="Programming"><meta property="article:tag" content="Apple"><meta property="article:tag" content="Function Builders"><meta property="article:tag" content="Wwdc2019"><meta name=twitter:card content="summary"><meta name=twitter:title content="Understanding Function Builders in Swift"><meta name=twitter:description content="Learn what Function Builders in Swift are, and how to use them"><meta name=twitter:creator content="@"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","url":"https://www.andyibanez.com/posts/understanding-function-builders/","headline":"Understanding Function Builders in Swift","description":"Learn what Function Builders in Swift are, and how to use them","datePublished":"2020-03-11","keywords":"swift,programming,apple,function builders,wwdc2019","author":{"@type":"Person","name":""}}</script><title>Understanding Function Builders in Swift - Andy Ibanez</title><link rel=stylesheet href=https://www.andyibanez.com/style.main.min.18f604b90ed15864d7faa967f1ef9eacb99e1c967eff38762ec29b7bf1ab5876.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-CE7T69YX8Y"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-CE7T69YX8Y")}</script></head><body><div class=wrapper><nav><div class=container><div class=language-selector></div></div></nav><header><div class=container><div class=header-group><div class=header-logo-container><a class=header-logo-link href=https://www.andyibanez.com/><img class=header-logo-circle src=https://www.andyibanez.com/img/andy_profile.png alt="Andy Ibanez logo"></a></div><div class=header-title><a href=https://www.andyibanez.com/>Andy Ibanez</a></div></div></div></header><nav><div class=container><div class=main-navigation><a href=/about/>About Me</a><a href=/posts/>Blog</a><a href=/projects/>Projects</a><a href=/tags/>Tags</a><a href=/contact/>Contact</a><a href=/privacy-policy/>Privacy policy</a></div></div></nav><div class=container><div class=search><input type=text id=searchInput placeholder="Type here to search"></div><div class="container search-results-container" hidden=true><div id=searchResults class=search-results></div></div></div><main><div class=container><article><h1 class=title>Understanding Function Builders in Swift</h1><p class=publish>Published on
<time class=post-date datetime=2020-03-11T07:00:00-04:00>March 11, 2020</time></p><p>WWDC2020 is just around the corner*, and it hasn&rsquo;t been one year since WWDC2019 took place. There is still a lot of ground to cover regarding the new tools and APIs demonstrated then. and In this article we will focus on a feature new to Swift itself: Function Builders.</p><p><em>*: Maybe. :(</em></p><p>If you have been hacking away at SwiftUI, you have probably been wondering how it makes it possible to build great UIs with very nice syntactic sugar. Other than <a href=https://www.andyibanez.com/posts/understanding-property-wrappers-swift/>property wrappers</a>, SwiftUI is also possible thanks to Function Builders. In this article, we will briefly mention how SwiftUI uses Function Builders, and later we will create our own function builders that have nothing not do with SwiftUI. This way, it will become evident why Function Builders are really neat, and why they don&rsquo;t have to be strictly tied to SwiftUI.</p><h1 id=understanding-function-builders>Understanding Function Builders</h1><p>&ldquo;Function Builder&rdquo; is a very fancy name for something very simple. Function Builders are nothing more and nothing less than syntactic sugar. With function builders, you can create more natural syntax for your code to make it more intuitive and easier to use and understand.</p><p>Function builders make it easier to build complex objects by providing more natural syntax for their creation.</p><p>If you have played with SwiftUI, you have most likely used <code>HStack</code> and <code>VStack</code> objects. They are <em>objects</em> though, so how come we can do something like this?:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>HStack {
</span></span><span style=display:flex><span>    Text(<span style=color:#a6e3a1>&#34;Hey&#34;</span>)
</span></span><span style=display:flex><span>    Text(<span style=color:#a6e3a1>&#34;I&#39;m Andy&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The answer is that part of <code>HStack</code>&rsquo;s constructor takes a <code>ViewBuilder</code> called <code>content</code>:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#f38ba8>init</span>(alignment: VerticalAlignment = .center, spacing: CGFloat? = <span style=color:#fab387>nil</span>, @ViewBuilder content: () -&gt; Content)
</span></span></code></pre></div><p>So when we use the <code>content</code> parameter, we are instructing SwiftUI to create a <code>HStack</code> composed of multiple different views within - a complex view. SwiftUI will later convert it into in an object behind the scenes (a <code>TupleView&lt;View, View></code>, to be more specific) that it uses internally in order to render it. You can theoretically use SwiftUI without the syntactic sugar provided by Function Builders, but your code would look like a soup of generics in a world with no horizontal limits.</p><p>SwiftUI has multiple objects that work like <code>HStack</code>. Wouldn&rsquo;t it be interesting if we could create our own function builders? To better understand Function Builders and have a better idea of what SwiftUI does behind the scenes with them, we are going to build a few them to get the concept across.</p><h2 id=building-custom-function-builders>Building Custom Function Builders</h2><p>To create a function builder, you need to declare a <code>struct</code> marked as <code>@_functionBuilder</code>. Next, your struct must have a static method called <code>buildBlock</code>, and this method must take at least one argument of any type. This argument will be what you write inside the curly braces when calling your function builder. In SwiftUI, these are <code>View</code>s. Finally, the <code>buildBlock</code> function can return something to the caller, which can be any type as well.</p><h3 id=a-simple-function-builder>A Simple Function Builder</h3><p>In the following example, we are going to create a function builder that takes strings, and returns their lengths. We will later explore how to use it:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>@_functionBuilder
</span></span><span style=display:flex><span><span style=color:#f38ba8>struct</span> <span style=color:#f9e2af>StringCharacterCounterBuilder</span> {
</span></span><span style=display:flex><span>  <span style=color:#f38ba8>static</span> <span style=color:#f38ba8>func</span> <span style=color:#89b4fa>buildBlock</span>(<span style=color:#fab387>_</span> strings: <span style=color:#89dceb>String</span>...) -&gt; [<span style=color:#89dceb>Int</span>] {
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>return</span> strings.<span style=color:#89dceb>map</span> { <span style=color:#f5e0dc>$0</span>.<span style=color:#89dceb>count</span> }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=utilizing-function-builders>Utilizing Function Builders</h3><p>Now that we have the function builder, the only thing left to do is to use it.</p><p>To do that, we will create a class with an initializer that takes an argument marked with our function builder:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#f38ba8>class</span> <span style=color:#f9e2af>CharacterCounter</span> {
</span></span><span style=display:flex><span>  <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>counterArray</span>: [<span style=color:#89dceb>Int</span>]
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#f38ba8>init</span>(@StringCharacterCounterBuilder <span style=color:#fab387>_</span> content: () -&gt; [<span style=color:#89dceb>Int</span>]) {
</span></span><span style=display:flex><span>    counterArray = content()
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#f38ba8>func</span> <span style=color:#89b4fa>showCounts</span>() {
</span></span><span style=display:flex><span>    counterArray.forEach { <span style=color:#89dceb>print</span>(<span style=color:#f5e0dc>$0</span>) }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>And finally, we can call our initializer like this:\</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>characterCounts</span> = CharacterCounter {
</span></span><span style=display:flex><span>  <span style=color:#a6e3a1>&#34;Andy&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e3a1>&#34;Ibanez&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#a6e3a1>&#34;Collects Pullip&#34;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Call the <code>showCounts()</code> to see it contains the content you expect:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>characterCounts.showCounts()
</span></span></code></pre></div><pre tabindex=0><code>4
6
15
</code></pre><p>Now, I realize this is a very abstract example, but hopefully you can see how function builders are used, and how they work.</p><p>In short, Function Builders:</p><ol><li>Let you create syntactic sugar to make code easier to understand and make it more intuitive.</li><li><em>Transform</em> content and hand it to the caller.</li><li>Allows us to create neat Domain Specific Languages (<em>DSL</em>), which is what SwiftUI essentially is.</li></ol><p>The above example was contrived, but if you understood how it works, let&rsquo;s try building something more interesting.</p><h1 id=building-a-real-function-builder>Building a Real Function Builder</h1><p>The previous example was extremely generic and its main purpose was to show <em>how</em> function builders work and the syntax around them. In this section we will explore a real function builder you may want to use in your own projects. We will create function builders to create <code>UIAlertController</code>s declaratively.</p><h2 id=easier-to-use-uialertcontrollers-with-function-builders>Easier to Use UIAlertControllers With Function Builders</h2><p>If I had to give an opinion on <code>UIAlertController</code>, is that it is one of the most tedious APIs to use on iOS development. First, you have to create your alert controller, and then you have to create each action item separately, just to add each one of them, one by one, to the alert controller manually. You can make it easier by extending <code>UIAlertController</code> to add a variable amount of actions, but we can make it even easier (and more interesting), if we create a small DSL <em>just</em> to create <code>UIAlertController</code>s with actions.</p><p>Our end goal will allow us to create <code>UIAlertController</code>s writing code like this:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>alert</span> = AlertController(
</span></span><span style=display:flex><span>    title: <span style=color:#a6e3a1>&#34;Delete all data?&#34;</span>,
</span></span><span style=display:flex><span>    message: <span style=color:#a6e3a1>&#34;All your data will be deleted!&#34;</span>,
</span></span><span style=display:flex><span>    style: .alert) {
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        AlertAction {
</span></span><span style=display:flex><span>            DestructiveTitle(<span style=color:#a6e3a1>&#34;Yes, Delete it All&#34;</span>)
</span></span><span style=display:flex><span>            AlertHandler {
</span></span><span style=display:flex><span>                <span style=color:#89dceb>print</span>(<span style=color:#a6e3a1>&#34;Deleting all data&#34;</span>)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        AlertAction {
</span></span><span style=display:flex><span>            DefaultTitle(<span style=color:#a6e3a1>&#34;Show More Options&#34;</span>)
</span></span><span style=display:flex><span>            AlertHandler {
</span></span><span style=display:flex><span>                <span style=color:#89dceb>print</span>(<span style=color:#a6e3a1>&#34;showing more options&#34;</span>)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        AlertAction {
</span></span><span style=display:flex><span>            CancelTitle(<span style=color:#a6e3a1>&#34;No, Don&#39;t Delete Anything&#34;</span>)
</span></span><span style=display:flex><span>            AlertHandler()
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>present(alert.alertController, animated: <span style=color:#fab387>true</span>)
</span></span></code></pre></div><p><img src=/img/fbs_alertcontroller.png alt="UIAlertController created with Function Builders"></p><p>In contrast, building this same <code>UIAlertController</code> in pure UIKit would be longer than it needs to be:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>alert</span> = UIAlertController(
</span></span><span style=display:flex><span>    title: <span style=color:#a6e3a1>&#34;Delete all data?&#34;</span>,
</span></span><span style=display:flex><span>    message: <span style=color:#a6e3a1>&#34;All your data will be deleted!&#34;</span>,
</span></span><span style=display:flex><span>    preferredStyle: .alert)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>deleteAction</span> = UIAlertAction(title: <span style=color:#a6e3a1>&#34;Yes, Delete it All&#34;</span>, style: .destructive) { (<span style=color:#fab387>_</span>) <span style=color:#cba6f7>in</span>
</span></span><span style=display:flex><span>    <span style=color:#89dceb>print</span>(<span style=color:#a6e3a1>&#34;Deleting all data&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>moreOptionsAction</span> = UIAlertAction(title: <span style=color:#a6e3a1>&#34;Show More Options&#34;</span>, style: .<span style=color:#cba6f7>default</span>) { (<span style=color:#fab387>_</span>) <span style=color:#cba6f7>in</span>
</span></span><span style=display:flex><span>    <span style=color:#89dceb>print</span>(<span style=color:#a6e3a1>&#34;Show more options&#34;</span>)
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>cancelAction</span> = UIAlertAction(title: <span style=color:#a6e3a1>&#34;No, Don&#39;t Delete Anything&#34;</span>, style: .cancel, handler: <span style=color:#fab387>nil</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>alert.addAction(deleteAction)
</span></span><span style=display:flex><span>alert.addAction(moreOptionsAction)
</span></span><span style=display:flex><span>alert.addAction(cancelAction)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>present(alert, animated: <span style=color:#fab387>true</span>)
</span></span></code></pre></div><p>The former is a more declarative approach, and it&rsquo;s both much quicker and easier to type.</p><h3 id=supporting-classes>Supporting Classes</h3><p>We will start by defining a few basic classes. These classes cover the title styles for the alerts, and the action to execute when one of them is tapped.</p><p>This small protocol definition will be used for the buttons:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#f38ba8>protocol</span> <span style=color:#f9e2af>AlertActionStyleProtocol</span> {
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>var</span> <span style=color:#f5e0dc>title</span>: <span style=color:#89dceb>String</span> { <span style=color:#cba6f7>get</span> }
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>var</span> <span style=color:#f5e0dc>style</span>: UIAlertAction.Style { <span style=color:#cba6f7>get</span> }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#f38ba8>struct</span> <span style=color:#f9e2af>DefaultTitle</span>: AlertActionStyleProtocol {
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>title</span>: <span style=color:#89dceb>String</span>
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>style</span>: UIAlertAction.Style
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>init</span>(<span style=color:#fab387>_</span> title: <span style=color:#89dceb>String</span>) {
</span></span><span style=display:flex><span>        <span style=color:#fab387>self</span>.title = title
</span></span><span style=display:flex><span>        <span style=color:#fab387>self</span>.style = .<span style=color:#cba6f7>default</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f38ba8>struct</span> <span style=color:#f9e2af>CancelTitle</span>: AlertActionStyleProtocol {
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>title</span>: <span style=color:#89dceb>String</span>
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>style</span>: UIAlertAction.Style
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>init</span>(<span style=color:#fab387>_</span> title: <span style=color:#89dceb>String</span>) {
</span></span><span style=display:flex><span>        <span style=color:#fab387>self</span>.title = title
</span></span><span style=display:flex><span>        <span style=color:#fab387>self</span>.style = .cancel
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f38ba8>struct</span> <span style=color:#f9e2af>DestructiveTitle</span>: AlertActionStyleProtocol {
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>title</span>: <span style=color:#89dceb>String</span>
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>style</span>: UIAlertAction.Style
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>init</span>(<span style=color:#fab387>_</span> title: <span style=color:#89dceb>String</span>) {
</span></span><span style=display:flex><span>        <span style=color:#fab387>self</span>.title = title
</span></span><span style=display:flex><span>        <span style=color:#fab387>self</span>.style = .destructive
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>One thing to keep in mind is that, when we write declarative code, we sometimes have to write more code in order to make the <em>end result</em> easier to write. You can probably make this better using inheritance, but I don&rsquo;t think there&rsquo;s a much of a problem doing it this way here.</p><p>The last independent class we need is the one that will handle the alert:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#f38ba8>struct</span> <span style=color:#f9e2af>AlertHandler</span> {
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>action</span>: () -&gt; <span style=color:#89dceb>Void</span>
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>init</span>(<span style=color:#fab387>_</span> action: @escaping () -&gt; <span style=color:#89dceb>Void</span> = {}) {
</span></span><span style=display:flex><span>        <span style=color:#fab387>self</span>.action = action
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Now we can start writing the function builders.</p><h3 id=the-function-builders>The Function Builders</h3><p>The first function builder we will build will allow us to create the <code>UIAlertAction</code>s.</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>@_functionBuilder
</span></span><span style=display:flex><span><span style=color:#f38ba8>struct</span> <span style=color:#f9e2af>UIAlertActionBuilder</span> {
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>static</span> <span style=color:#f38ba8>func</span> <span style=color:#89b4fa>buildBlock</span>
</span></span><span style=display:flex><span>        (
</span></span><span style=display:flex><span>        <span style=color:#fab387>_</span> style: AlertActionStyleProtocol,
</span></span><span style=display:flex><span>        <span style=color:#fab387>_</span> alertHandler: AlertHandler
</span></span><span style=display:flex><span>    ) -&gt; UIAlertAction {
</span></span><span style=display:flex><span>        <span style=color:#cba6f7>return</span> UIAlertAction(title: style.title, style: style.style) { <span style=color:#fab387>_</span> <span style=color:#cba6f7>in</span>
</span></span><span style=display:flex><span>            alertHandler.action()
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The object that will make use of this function builder is the following:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#f38ba8>class</span> <span style=color:#f9e2af>AlertAction</span> {
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>alertAction</span>: UIAlertAction
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>init</span>(@UIAlertActionBuilder <span style=color:#fab387>_</span> content: () -&gt; UIAlertAction) {
</span></span><span style=display:flex><span>        alertAction = content()
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>So far, all the code we have written allows us to create <code>UIAlertAction</code>s with this new syntax:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span>AlertAction {
</span></span><span style=display:flex><span>    DestructiveTitle(<span style=color:#a6e3a1>&#34;Yes, Delete it All&#34;</span>)
</span></span><span style=display:flex><span>    AlertHandler {
</span></span><span style=display:flex><span>        <span style=color:#89dceb>print</span>(<span style=color:#a6e3a1>&#34;Deleting all data&#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The body of the <code>AlertAction</code> calls the function builder. You can think of each statement as a parameter to the function builder.</p><p>The last function builder will allow us to create <code>UIAlertAction</code>s from <code>UIAlertAction</code>s, an we will use that to create the final <code>AlertController</code>:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#f38ba8>struct</span> <span style=color:#f9e2af>AlertControllerBuilder</span> {
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>static</span> <span style=color:#f38ba8>func</span> <span style=color:#89b4fa>buildBlock</span>(<span style=color:#fab387>_</span> actions: AlertAction...) -&gt; [UIAlertAction] {
</span></span><span style=display:flex><span>        <span style=color:#cba6f7>return</span> actions.<span style=color:#89dceb>map</span> { <span style=color:#f5e0dc>$0</span>.alertAction }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Finally, the class that will make use of the <code>AlertControllerBuilder</code> will create the <code>UIAlertController</code>:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#f38ba8>class</span> <span style=color:#f9e2af>AlertController</span> {
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>alertController</span>: UIAlertController
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>init</span>
</span></span><span style=display:flex><span>        (
</span></span><span style=display:flex><span>        title: <span style=color:#89dceb>String</span>,
</span></span><span style=display:flex><span>        message: <span style=color:#89dceb>String</span>,
</span></span><span style=display:flex><span>        style: UIAlertController.Style,
</span></span><span style=display:flex><span>        @AlertControllerBuilder <span style=color:#fab387>_</span> content: () -&gt; [UIAlertAction]
</span></span><span style=display:flex><span>    ) {
</span></span><span style=display:flex><span>        <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>alert</span> = UIAlertController(
</span></span><span style=display:flex><span>            title: title,
</span></span><span style=display:flex><span>            message: message,
</span></span><span style=display:flex><span>            preferredStyle: style
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        content().forEach { alert.addAction(<span style=color:#f5e0dc>$0</span>) }
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#fab387>self</span>.alertController = alert
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>You can now use the code in the top of the session to create <code>UIAlertController</code>s much easier, faster, and with nice declarative syntax.</p><p>I will be curious to see if you have any ideas to improve this. If you play around with this idea and come up with any interesting improvements, please let me know.</p><h1 id=conclusion>Conclusion</h1><p>Swift 5 introduced many fascinating features to Swift. From property wrappers to function builders. If you use them responsibly, you can create DSLs for many tasks no matter how specific, and simplify the use of common APIs along the way.</p><p>I have converted the <code>AlertController</code> into a Swift Package you can add to your own projects. Its name is <code>DeclarativeAlertController</code>, and you can find it <a href=https://github.com/AndyIbanez/DeclarativeAlertController>here</a>.</p></article></div></main><footer><div class=container><div class=footer-navigation><a href=https://github.com/AndyIbanez><span class=inline-svg><svg viewBox="0 0 42 40" id="svg4" width="42" height="40"><path fill="currentColor" d="m14.20936 32.20794c0 .16542-.19024.29776-.4301.29776-.27295.0248-.46319-.10752-.46319-.29776.0-.16542.19024-.29776.4301-.29776.24814-.0248.46319.10752.46319.29776zm-2.57234-.3722c-.0579.16542.10753.35566.35566.40528.21505.0827.46319.0.51282-.16542.0496-.16542-.10753-.35566-.35566-.4301-.21505-.0579-.45492.0248-.51282.19024zm3.65586-.14061c-.23986.0579-.40529.21505-.38047.40528.0248.16543.23986.27295.488.21505.23986-.0579.40528-.21505.38047-.38047-.0248-.15715-.24813-.26468-.488-.23986zM20.73531-.19734273e-6C9.2632-.19734273e-6.48748 8.7095398.48748 20.18166c0 9.17273 5.77328 17.02207 14.01964 19.78464 1.05871.19024 1.43091-.46319 1.43091-1.00081.0-.51282-.0248-3.34156-.0248-5.0785.0.0-5.78982 1.24067-7.00568-2.46481.0.0-.94292-2.40691-2.29939-3.02725.0.0-1.8941-1.29857.13234-1.27376.0.0 2.05952.16542 3.19267 2.13396 1.81139 3.19267 4.84691 2.27457 6.02969 1.72868.19023-1.32339.72786-2.24149 1.32338-2.78739-4.62358-.51281-9.28852-1.18278-9.28852-9.13964.0-2.27458.62861-3.416 1.95199-4.87172-.21505-.53763-.9181-2.7543.21506-5.6161302 1.72867-.53762 5.7071 2.2332202 5.7071 2.2332202 1.65424-.46319 3.43254-.70305 5.1943-.70305 1.76176.0 3.54006.23986 5.1943.70305.0.0 3.97843-2.7791202 5.7071-2.2332202 1.13315 2.8701002.4301 5.0785002.21505 5.6161302 1.32339 1.46399 2.13397 2.60542 2.13397 4.87172.0 7.98168-4.87172 8.61856-9.49531 9.13964.76095.65342 1.4061 1.8941 1.4061 3.83782.0 2.78739-.0248 6.23647-.0248 6.9147.0.53763.38047 1.19105 1.43091 1.00082 8.27117-2.74603 13.87903-10.59537 13.87903-19.7681C41.51252 8.7095398 32.20745-.19734273e-6 20.73533-.19734273e-6zM8.52706 28.52727c-.10752.0827-.0827.27295.0579.4301.13234.13234.32258.19024.4301.0827.10753-.0827.0827-.27295-.0579-.4301-.13233-.13234-.32257-.19024-.4301-.0827zM7.63378 27.8573c-.0579.10753.0248.23987.19023.32258.13234.0827.29777.0579.35566-.0579C8.23757 28.01446 8.15487 27.88212 7.98944 27.7994 7.82401 27.7498 7.69168 27.7746 7.63378 27.8573zm2.67986 2.94454c-.13234.10753-.0827.35566.10752.51281.19024.19024.4301.21505.53763.0827.10752-.10752.0579-.35566-.10753-.51281-.18196-.19024-.4301-.21505-.53762-.0827zM9.37072 29.58598c-.13234.0827-.13234.29776.0.488.13234.19023.35566.27295.46319.19023.13234-.10752.13234-.32257.0-.51281-.1158-.19024-.33085-.27295-.46319-.16542z" id="path2" style="stroke-width:.08271171"/></svg>
</span></a><a href=https://x.com/AndyIbanezK><span class=inline-svg><svg viewBox="0 0 50 40" id="svg4" width="50" height="40"><path fill="currentColor" d="m44.56253 9.96871c.0313.43748.0313.87506.0313 1.31254C44.59383 24.62494 34.43764 40 15.87508 40 10.1563 40 4.84383 38.34368.37506 35.4688c.81253.0937 1.5937.12495 2.4375.12495 4.71867.0 9.06249-1.5937 12.53125-4.31245-4.43751-.0938-8.15627-3.00003-9.43754-7.00006.62505.0937 1.25001.15622 1.90632.15622.90622.0 1.81254-.12505 2.65624-.34369C5.84384 23.15619 2.37498 19.09373 2.37498 14.18748v-.12495c1.3437.75 2.90633 1.21875 4.56246 1.28117-2.71876-1.81253-4.49993-4.90624-4.49993-8.40627.0-1.87497.4999-3.59372 1.37496-5.09373 4.96877 6.125 12.43756 10.12493 20.81248 10.56251-.15622-.75001-.25-1.53118-.25-2.31245C24.37495 4.5312 28.87498.0 34.46871.0c2.90623.0 5.53121 1.21875 7.37501 3.1875 2.28118-.43748 4.46867-1.28127 6.40626-2.43749-.75011 2.3438-2.34381 4.31255-4.43751 5.56246 2.03127-.21864 4.00003-.78126 5.81247-1.56244-1.37477 1.99992-3.09362 3.7811-5.06237 5.21868z" id="path2" style="stroke-width:.09619153"/></svg>
</span></a><a href=https://www.linkedin.com/in/andyibanez/><span class=inline-svg><svg viewBox="0 0 41 40" id="svg4" width="41" height="40"><path fill="currentColor" d="M9.45332 40H1.16028V13.29405H9.45332zM5.30234 9.65111c-2.65185.0-4.80279-2.19648-4.80279-4.84832a4.80279 4.80279.0 019.60558.0c0 2.65184-2.15184 4.84832-4.80279 4.84832zM40.49152 40H32.21633V26.99971c0-3.09828-.0625-7.07159-4.3117-7.07159-4.3117.0-4.97243 3.36615-4.97243 6.84837V40H14.64808V13.29405h7.95375v3.64294h.11608c1.10716-2.09827 3.81169-4.3126 7.8466-4.3126 8.39304.0 9.93594 5.52691 9.93594 12.70564V40z" id="path2" style="stroke-width:.08928771"/></svg>
</span></a><a href=https://www.andyibanez.com/blog/index.xml><span class=inline-svg><svg viewBox="0 0 40 40" id="svg4" width="40" height="40"><path fill="currentColor" d="m11.435816 34.282008c0 3.15793-2.5599899 5.71793-5.7179299 5.71793s-5.717840022654-2.56-5.717840022654-5.71793c0-3.15794 2.559990022654-5.71793 5.717930022654-5.71793s5.7178399 2.56008 5.7178399 5.71793zm15.68388 4.21873C26.373806 24.697208 15.317496 13.626978 1.4992361 12.880288.68361608 12.836188.46077346e-4 13.491538.46077346e-4 14.308318v4.29186c0 .75134.579460002654 1.38142 1.329190022654 1.43017 9.9849699.65036 17.9886099 8.63408 18.6402999 18.6403.0488.74973.67893 1.3292 1.43018 1.3292h4.29186c.81687 9e-5 1.47223-.68348 1.42812-1.49911zm12.87933.0257C39.249566 17.649718 22.452206.754048 1.4735261.00092799867.66727608-.027972.46077346e-4.623338.46077346e-4 1.430038v4.29177c0 .77008.610270002654 1.39687 1.379730022654 1.42848 17.0694999.6999 30.7701699 14.40316 31.4699899 31.46999.0315.76946.6583 1.37972 1.42848 1.37972h4.29177c.8066-8e-5 1.45794-.66731 1.42901-1.47356z" id="path2" style="stroke-width:.08928544"/></svg>
</span></a><a href=https://www.andyibanez.com/curriculum/><span class=inline-svg><svg viewBox="0 0 15680 20480" id="svg4" width="35" height="40"><path fill="currentColor" d="M11655.83 12824.48 7840.0001 16640.464 4024.17 12824.48c-2859.863 123.906-5143.7701 2463.775-5143.7701 5352.003v384.005c0 1059.853 859.96601 1919.512 1919.92167 1919.512H14879.678c1059.956.0 1919.922-859.659 1919.922-1919.512v-384.005c0-2888.228-2283.906-5228.097-5143.77-5352.003zM-575.64445 3193.1279l256.0032 59.9048v2335.7732c-279.9651 167.9381-479.9548 459.7818-479.9548 812.0422.0 335.8762 183.9639 615.9437 443.96075 787.9778l-623.9822 2491.9352c-67.9944 275.9716 84.02025 559.6229 303.9782 559.6229H996.31762c219.95798.0 371.97268-283.6513 303.97828-559.6229L676.31362 7188.8259c259.99685-172.0341 443.96078-452.1016 443.96078-787.9778.0-352.2604-199.98973-644.1041-479.95483-812.0422V3484.9716l2639.90503 635.9119c-344.0171 688.1366-559.9814 1456.1463-559.9814 2279.9646.0 2827.8113 2291.8942 5119.5519 5119.7569 5119.5519 2827.8619.0 5119.7569-2291.7406 5119.7569-5119.5519.0-823.8183-211.971-1591.828-559.982-2279.9646l3851.824-927.7556c727.971-176.1302 727.971-1083.9175.0-1260.0477L8635.9653 92.929226c-519.9937-123.905551-1067.943-123.905551-1587.9367.0L-575.64445 1928.9841c-723.92585 176.1302-723.92585 1088.0136.0 1264.1438z" id="path2" style="stroke-width:39.99821472"/></svg>
</span></a><a href=https://www.andyibanez.com/contact-me><span class=inline-svg><svg viewBox="0 0 40 40" id="svg4" width="40" height="40"><path fill="currentColor" d="m39.99999 36.249999c0 2.0711-1.6789 3.75-3.74999 3.75H3.75c-2.07109.0-3.74999-1.6789-3.74999-3.75v-20.56843a3.7499996 3.7499996.0 011.43648-2.95125c1.94633-1.5257 3.55476-2.7628904 12.82812-9.4930404C15.57906 2.2789186 18.18727-.02709136 20 .00024864227 21.81234-.02745136 24.42156 2.2793086 25.73539 3.2371986c9.27242 6.72945 10.88304 7.9683604 12.82812 9.4931204a3.7499996 3.7499996.0 011.43648 2.95125zm-5.13015-15.35976c-.20024-.29125-.60156-.35898-.88586-.14898-1.78476 1.3182-4.33297 3.18008-8.24859 6.02179-1.31445.95828-3.92266 3.26414-5.73539 3.23672-1.81336.0269-4.41867-2.2768-5.73539-3.23672-3.91515-2.8414-6.46359-4.70343-8.24859-6.02179-.2843-.21-.68562-.14227-.88586.14898l-.70875 1.03094a.62484368.62484368.0 00.14367.8568c1.78805 1.32023 4.33235 3.1789 8.2268 6.00531 1.5839 1.15476 4.41593 3.73539 7.20812 3.71664 2.79094.0189 5.62195-2.56024 7.20804-3.71664 3.89453-2.82649 6.43891-4.68516 8.2268-6.00531a.62484368.62484368.0 00.14367-.8568z" id="path2" style="stroke-width:.07812498"/></svg></span></a></div></div><p class=made-with-love><a href=https://github.com/humrochagf/colordrop><b>Colordrop</b>
</a><span>theme | Made </span><span>by</span>
<a href=https://humberto.io/><b>Humberto Rocha</b></a></p></footer></div><script src=/copy/copy.js></script><script src=/search/elasticlunr.min.js></script><script src=/search/search.js></script><script>loadSearch()</script></body></html>