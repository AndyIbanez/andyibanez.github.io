<!doctype html><html prefix="og: http://ogp.me/ns#" lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,user-scalable=no"><meta http-equiv=x-ua-compatible content="ie=edge"><script async src="https://www.googletagmanager.com/gtag/js?id=G-CE7T69YX8Y"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-CE7T69YX8Y")}</script><link rel=icon type=image/png href=https://www.andyibanez.com/img/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://www.andyibanez.com/img/favicon-16x16.png sizes=16x16><link rel=canonical href=https://www.andyibanez.com/posts/parametrized-shortcuts/><link rel=alternate hreflang=en href=https://www.andyibanez.com/posts/parametrized-shortcuts/ title><meta name=description content="Learn to implement parametrized Siri Shortcut Actions in your iOS apps."><meta name=author content><meta name=theme-color content="#292148"><meta itemprop=name content="Implementing Parametrizable Shortcut Actions for your iOS Apps"><meta itemprop=description content="Learn to implement parametrized Siri Shortcut Actions in your iOS apps."><meta itemprop=datePublished content="2020-01-08T07:00:00-04:00"><meta itemprop=dateModified content="2020-01-08T07:00:00-04:00"><meta itemprop=wordCount content="3083"><meta itemprop=keywords content="swift,ios,ipados,watchos,iOS13,wwdc2019,shortcuts,siri"><meta property="og:url" content="https://www.andyibanez.com/posts/parametrized-shortcuts/"><meta property="og:site_name" content="Andy Ibanez"><meta property="og:title" content="Implementing Parametrizable Shortcut Actions for your iOS Apps"><meta property="og:description" content="Learn to implement parametrized Siri Shortcut Actions in your iOS apps."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-01-08T07:00:00-04:00"><meta property="article:modified_time" content="2020-01-08T07:00:00-04:00"><meta property="article:tag" content="Swift"><meta property="article:tag" content="Programming"><meta property="article:tag" content="Apple"><meta property="article:tag" content="Ios"><meta property="article:tag" content="Ipados"><meta property="article:tag" content="Watchos"><meta name=twitter:card content="summary"><meta name=twitter:title content="Implementing Parametrizable Shortcut Actions for your iOS Apps"><meta name=twitter:description content="Learn to implement parametrized Siri Shortcut Actions in your iOS apps."><meta name=twitter:creator content="@"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","url":"https://www.andyibanez.com/posts/parametrized-shortcuts/","headline":"Implementing Parametrizable Shortcut Actions for your iOS Apps","description":"Learn to implement parametrized Siri Shortcut Actions in your iOS apps.","datePublished":"2020-01-08","keywords":"swift,programming,apple,ios,ipados,watchOS,iOS13,wwdc2019,shortcuts,siri","author":{"@type":"Person","name":""}}</script><title>Implementing Parametrizable Shortcut Actions for your iOS Apps - Andy Ibanez</title><link rel=stylesheet href=https://www.andyibanez.com/style.main.min.18f604b90ed15864d7faa967f1ef9eacb99e1c967eff38762ec29b7bf1ab5876.css><script async src="https://www.googletagmanager.com/gtag/js?id=G-CE7T69YX8Y"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-CE7T69YX8Y")}</script></head><body><div class=wrapper><nav><div class=container><div class=language-selector></div></div></nav><header><div class=container><div class=header-group><div class=header-logo-container><a class=header-logo-link href=https://www.andyibanez.com/><img class=header-logo-circle src=https://www.andyibanez.com/img/andy_profile.png alt="Andy Ibanez logo"></a></div><div class=header-title><a href=https://www.andyibanez.com/>Andy Ibanez</a></div></div></div></header><nav><div class=container><div class=main-navigation><a href=/about/>About Me</a><a href=/posts/>Blog</a><a href=/projects/>Projects</a><a href=/tags/>Tags</a><a href=/contact/>Contact</a><a href=/privacy-policy/>Privacy policy</a></div></div></nav><div class=container><div class=search><input type=text id=searchInput placeholder="Type here to search"></div><div class="container search-results-container" hidden=true><div id=searchResults class=search-results></div></div></div><main><div class=container><article><h1 class=title>Implementing Parametrizable Shortcut Actions for your iOS Apps</h1><p class=publish>Published on
<time class=post-date datetime=2020-01-08T07:00:00-04:00>January 8, 2020</time></p><p>All the way back to 2016, a group of very talented iOS developers released <a href=workflow.is>Workflow</a>, a very popular app to let users create actions of different kinds within the system&rsquo;s constraints. You could create and automate different tasks, such as controlling a server via SSH, downloading all the images from a website, and more&mldr; Much, much more.</p><p>Apple saw the power of the app and <a href=https://techcrunch.com/2017/03/22/apple-has-acquired-workflow-a-powerful-automation-tool-for-ipad-and-iphone/>acquired</a> it in March 2017. This was very exciting, but we didn&rsquo;t hear anything from the app since. Until WWDC 2018. Apple revealed a new app: Shortcuts. This app was built on top of Workflow, and as an Apple app, it allowed it to do many things that Workflow just wasn&rsquo;t allowed to do, such as toggling system settings, integrating it with other apps (!!), and it was also natively integrated into Siri.</p><p>This was in iOS 12, and as the initial release of Shortcuts, it was still very limited. Developers could integrate Shortcuts into their apps, but they were limited and there was no way to parametrize them.</p><p>In iOS 13, the Shortcuts app is now better than ever. And developers can now create actions that permit users to customize them. This allows them to create powerful shortcuts, with your action serving as a functional organ in them.</p><hr>**Note**<p>A <em>Shortcut</em> is made of <em>Actions</em>. A shortcut executes a series of <em>Actions</em> to get to a result. Apps can expose different actions to Siri and the Shortcuts app.</p></hr><p>You can go beyond want to creating simple shortcuts: you can create <em>conversational Siri actions</em>. This is very cool, because allows Siri to respond differently depending on how the user replies to her queries.</p><p>In this article, we will create a few actions with parameters to explain how the system works, so you can start writing your own parametrizable actions for your own apps. The sample project we created will be attached at the end of this article.</p><h1 id=thinking-about-parametrized-shortcuts>Thinking About Parametrized Shortcuts.</h1><p>You may be wondering why parametrized shortcuts are useful. Prior to iOS 13, we could get similar behavior to parametrized shortcuts by leveraging the clipboard to move data inside and outside your action.</p><p>With parametrized shortcuts, you can think of them as if they were functions - the traditional functions you know from the programming world. A function is a black box which takes input (parameters) and produces some output.</p><p>This way, you can let users pass in variables or results from other actions into your own action, operate on it, and optionally produce an output.</p><h1 id=implementing-parametrized-shortcuts-in-your-ios-app>Implementing Parametrized Shortcuts in Your iOS App.</h1><p>We will create a few parametrized shortcuts that allow you do basic math operations. Along the way, we will modify the shortcuts to show what kind of features you can implement.</p><h2 id=project-setup>Project Setup</h2><p>The setup is the same as it is in iOS 12, so feel to skip this section if your app already uses the Intents extension.</p><p>To add these type of shortcuts in your App, you will need to add the <code>Siri</code> capability in your <code>Signing & Capabilities</code> tab of your main app&rsquo;s target. You will also need to add a new Target of type <code>Intents Extension</code> (File -> New -> Target -> <code>Intents Extension</code>). This will also link against the <code>SiriKit</code> framework.</p><h2 id=creating-the-intent-definition-file>Creating the Intent Definition File</h2><p>Next, you need to add a <code>intentdefinition</code> file and share it across all your targets. To do this, right-click your project blueprint on the Navigator and select &ldquo;Add New File&rdquo;. Search for &ldquo;SiriKit Intent Definition File&rdquo; and click Next. Finally, on the Inspector, add it to all your Targets.</p><p>if you have done this prior to iOS 13, prepare to see a lot of changes here.</p><p>An <code>Intent</code> is a definition of something users could want to do. If you want to create an action to let users add two numbers, that action is an <em>Intent</em>. There&rsquo;s a bunch of pre-defined intents provided by the system, such as Messages, Photo Search, and more, but we will not be talking about them today.</p><p>Now that you have created the <code>intentdefinition</code> file, you can start working on your Shortcuts.</p><p>This file allows you to structure your shortcuts and to create all the custom types involved in their execution. Here, you can define what variables take part of your Actions. You can define the combinations of variables allowed, default values for them, constraints, and more. You structure your actions in <code>Intents</code>, which have <code>variables</code>, and you can configure them as you see fit.</p><h3 id=creating-intents>Creating Intents.</h3><p>Open the <code>intentdefinition</code>, scroll to the bottom, of the left pane, click the &ldquo;+&rdquo; button, and select <code>New Intent</code>.</p><p>We will create the Intent to add two numbers together.</p><p>For now, copy the following configuration. I&rsquo;m just showing the configuration for <code>firstNumber</code>, but you need to do the same thing for <code>secondNumber</code>:</p><p><img src=/img/shortcuts_intent_config.png alt="Intent Variable Configuration"></p><p>Before we move on, let&rsquo;s talk about the different configurations each action can take.</p><h4 id=intents-configuration>Intents Configuration</h4><h5 id=basic-configuration-and-variable-configuration>Basic Configuration and Variable Configuration</h5><p>The <code>Category</code> is a way to classify your action. This helps the system organize the entire actions from across all the apps into categories. We use the <code>Generic</code> <code>Run</code> category here, because it&rsquo;s hard to categorize in a different way.</p><p>The <code>Title</code> is the title of the action in the Shortcuts app. The <code>Description</code> is a small description of the action. You can write what it does and show short instructions to explain your users how to use it.</p><p><img src=/img/adds_two_numbers.png alt="Action Title"></p><p><img src=/img/adds_two_nums_desc.png alt="Action Description"></p><p>You can also set a <code>default image</code>, and whether the user should always be asked before running the Shortcut.</p><p>Next, you configure the variables themselves. They are nicely named &ldquo;Parameters&rdquo; in the UI. The user will see the <code>Display Name</code> of the parameter in the Shortcuts Action UI. The <code>Type</code> defines what kind of parameter it is (String, Int, a custom type as an enum, etc). You can also pass in a list of these numbers (so you could create an action that adds all the numbers in a list, for example).</p><p>The <code>User-Facing</code> option is what allows the user to customize the action in Shortcuts. If you disable this, users cannot supply their own values.</p><p>The <code>Dynamic Options</code> constraints the variable to a pre defined list of values. The user cannot provide this value if it&rsquo;s checked.</p><p>In the <code>Relationship</code> section, we can define a <code>Parent Variable</code>. With this variable, you can choose whether to show this variable or not to the user depending on the value of the parent.</p><p>Now that all the configurations starting on <code>Relationship</code> are only accesible if you have the <code>User-Facing</code> box checked.</p><p>The <code>Input</code> section allows to define the UI and constraints for our values. The configurations here are self-explanatory: In case of Integers, you can decide if you want a textfield or stepper to let your end user interact with your action, or and you can set max, min, and a default value for that particular variable.</p><p>If you run the app, it will automatically add your Intents to the Shortcuts app. Open the app, create a new Shortcut, and search for your <code>Add Two Numbers</code> action. When you add the action, it will look like this:</p><p><img src=/img/basic_shortcuts_ui.png alt="Shortcuts Configuration Screen"></p><p>But we can make it look a little bit prettier and more user friendly.</p><h5 id=shortcuts-app-configurations>Shortcuts app Configurations</h5><h6 id=parameters-and-inputs>Parameters and Inputs</h6><p>The <code>Input Parameter</code> allows you to define what variable will receive the value outputted from the previous action. There&rsquo;s no way to define more receiving variables at this time, but users can configure variables in the action and pass in more data that way.</p><p>The <code>Key Parameter</code> will let Siri Suggestions suggest values for the chosen variable.</p><p>The next section is more interested, as it allows you to define different variable combinations. You can define what kind of combinations should work, so the user has a sense of optional values to configure the action further. Along with the combinations, you can pass in a summary. This summary a user-facing string, and you can customize it as such. You can display variables in this screen, and the UI will show a string with place holders to the user.</p><p>If you add the string &ldquo;Add <code>firstNumber</code> and <code>secondNumber</code> together&rdquo;, while you write your string, you will get suggestions to add the variables as placeholders. At the end, it will look like this:</p><p><img src=/img/shortcut_summary_cust.png alt="Shortcut Summary Customization"></p><p>Building and running the app will update the Shortcut Action to look like this:</p><p><img src=/img/friendly_shortcuts_ui.png alt="User Friendly Shortcut"></p><p>In order to actually configure different Supported Combinations, you need to make parameters dependent of others with the <code>Parent Parameter</code> configuration. In our case we need two numbers to add together, so we won&rsquo;t be using different combinations.</p><h6 id=outputs-and-results>Outputs and Results</h6><p>Before we can write code, we have to finish up the Shortcut Intent Configuration. We have configured the Inputs, so let&rsquo;s deal with the Outputs now.</p><p>Below the <code>AddNumbers</code> intent, there&rsquo;s a &ldquo;Response&rdquo;. Here you can configure the outputs for your Shortcut. Copy this simple Response output:</p><p><img src=/img/shortcut_output_response.png alt="Add Numbers Response"></p><p>You can define multiple properties that your Action can output. Give it a <code>Display Name</code> for your user to see, a <code>Type</code> (in our case, an Integer, since we are adding Integers), and whether it&rsquo;s an array of multiple values. On <code>Output</code> choose <code>Addition</code>, and this way our Shortcut can now be chained to other actions from other apps, including system ones.</p><h2 id=implementing-shortcut-action-logic>Implementing Shortcut Action Logic</h2><p>Now is a good time to add logic to our new action. The idea is to illustrate how parametrized actions work before we talk about more advanced configuration options.</p><p>Open the <code>â€ŒIntentHandler.swift</code> file. You will notice that Apple provides a lot of code for handling message intents as an example. We don&rsquo;t really need all that, so let&rsquo;s simplify the entire content of this class. You can replace the whole file with this:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#f38ba8>class</span> <span style=color:#f9e2af>IntentHandler</span>: INExtension {
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>override</span> <span style=color:#f38ba8>func</span> <span style=color:#89b4fa>handler</span>(<span style=color:#cba6f7>for</span> intent: INIntent) -&gt; <span style=color:#89dceb>Any</span> {
</span></span><span style=display:flex><span>        <span style=color:#cba6f7>return</span> <span style=color:#fab387>self</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>The way I write my handlers is by letting the default <code>IntentHandler</code> class launch my own handlers. Like the name implies, this class handles Shortcuts for you.</p><p>Create a new file called <code>AddNumbersIntentHandler.swift</code> in your <code>Intents</code> target. I implemented mine as so:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#f38ba8>class</span> <span style=color:#f9e2af>AddNumbersIntentHandler</span>: NSObject, AddNumbersIntentHandling {
</span></span><span style=display:flex><span>  <span style=color:#f38ba8>func</span> <span style=color:#89b4fa>handle</span>(intent: AddNumbersIntent, completion: @escaping (AddNumbersIntentResponse) -&gt; <span style=color:#89dceb>Void</span>) {
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>firstNumber</span> = intent.firstNumber!
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>secondNumber</span> = intent.secondNumber!
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>result</span> = NSNumber(value: firstNumber.intValue <span style=color:#89dceb;font-weight:700>+</span> secondNumber.intValue)
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>response</span> = AddNumbersIntentResponse.success(addition: result)
</span></span><span style=display:flex><span>    completion(response)
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#f38ba8>func</span> <span style=color:#89b4fa>resolveSecondNumber</span>(<span style=color:#cba6f7>for</span> intent: AddNumbersIntent, with completion: @escaping (AddNumbersSecondNumberResolutionResult) -&gt; <span style=color:#89dceb>Void</span>) {
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>var</span> <span style=color:#f5e0dc>result</span>: AddNumbersSecondNumberResolutionResult = .unsupported()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>defer</span> { completion(result) }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>if</span> <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>number</span> = intent.secondNumber?.intValue {
</span></span><span style=display:flex><span>      result = AddNumbersSecondNumberResolutionResult.success(with: number)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#f38ba8>func</span> <span style=color:#89b4fa>resolveFirstNumber</span>(<span style=color:#cba6f7>for</span> intent: AddNumbersIntent, with completion: @escaping (AddNumbersFirstNumberResolutionResult) -&gt; <span style=color:#89dceb>Void</span>) {
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>var</span> <span style=color:#f5e0dc>result</span>: AddNumbersFirstNumberResolutionResult = .unsupported()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>defer</span> { completion(result) }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>if</span> <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>number</span> = intent.secondNumber?.intValue {
</span></span><span style=display:flex><span>      result = AddNumbersFirstNumberResolutionResult.success(with: number)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>An explanation of what&rsquo;s going on here is in order.</p><p>SiriKit will automatically create some classes and protocols for you, including a <code>-Handling</code> protocol file, based on the contents of your intent definition file. My intent is called <code>AddNumbers</code>, so Xcode generated <code>AddNumbersIntentHandling</code> for me, and I&rsquo;m implementing its methods. Also, our class is inheriting from <code>NSObject</code> because the <code>-Handling</code> protocol created for us requires it. You could implement the requirements yourself, but you can save yourself the trouble by simply inheriting from <code>NSObject</code>.</p><p>This protocol requires you implement a few methods. The <code>handle</code> method exists in all <code>-Handling</code> protocols. The other required methods depend on the parameters you define as part of your intent, and they are all about resolving the Parameters. Here, both methods are implemented in the same way and they both check that we do have some integer value in <code>firstNumber</code> and <code>secondNumber</code>. If we don&rsquo;t, we pass in a value to the system. Xcode also generates <code>-Result</code> objects for us, and that&rsquo;s what we use to let the system know about the status of our variables. In general, you can resolve to anything. In our case, we are just resolving to the numbers themselves because that&rsquo;s what we want. You can resolve to different values depending on the needs of your action.</p><p>The <code>handle</code> function will actually perform our operation: In our case, it will add <code>firstNumber</code> and <code>secondNumber</code> together and return the result back to the system. In the <code>intentdefinition</code> file, we defined that a variable called <code>addition</code> will contain the output of our action - the sum of both numbers, so to pass this result back to the system, we create a new <code>-Response</code> object - also generated by Xcode -, specify it was a <code>success</code>, and pass it the output variable as part of that method call.</p><p>Go back to <code>IntentHandler.swift</code> and replace the body of the <code>handle(for:)</code> method with the following:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>addNumbersIntentHandler</span> = AddNumbersIntentHandler()
</span></span><span style=display:flex><span><span style=color:#cba6f7>return</span> addNumbersIntentHandler
</span></span></code></pre></div><p>Like we said earlier, you can use this method to return different handlers for different intents. We will do that a little bit later, towards the end of this article.</p><p>Run your Extension now, and create a shortcut that uses your &ldquo;Add Two Numbers&rdquo; action. Give it two numbers, and you will see that it works&mldr; Sort of. Shortcuts is trying to display some UI to the user, but it ends up doing nothing and displaying nothing at all. When you dismiss this UI, Shortcuts will continue executing your action and show you the final result in the native UI.</p><p>This weird UI is part of the <code>Intents UI</code> framework that was added to your project automatically when you added the Siri capability. Exploring this framework is out of the scope of this article, and we don&rsquo;t even need it. The easiest way to remove it, is to go to the <code>Info.plist</code> file of the <code>Intents UI</code> target, expand <code>NSExtension</code>, expand <code>NSExtensionAttributes</code>, expand <code>IntentsSupported</code>, and finally delete the entry that has your custom intent type there. Once you do that, when you build and run your action again, Shortcuts will no longer try to open the Intents UI.</p><p>And that&rsquo;s great. You have now created a new action that can take input, produce and output, and that it can work inside a chain of other actions from other apps is it can receive data from anyone, and produce an output that can be received by anyone.</p><p><img src=/img/shortcut_action_result.png alt="Shortcut Action Result"></p><h2 id=using-enums-to-make-richer-parametrizable-actions>Using Enums to Make Richer Parametrizable Actions</h2><p>What we did so far allows us to create very interesting actions for our apps. But we can add more features to make them friendlier for our users.</p><p>Suppose you want to add a new action to subtract two numbers. Your first thought may be to just duplicate the &ldquo;AddNumbers&rdquo; Intent, rename it to &ldquo;SubtractNumbers&rdquo;, and implement a new copy-paste version of AddNumbers to add the subtraction method.</p><p>We can avoid all that code duplication by implementing an enum. An enum you know and love from writing Swift. You can then let the user choose an enum as part of the action&rsquo;s parameters. In this case, we will implement an <code>enum</code> called <code>Operation</code> which will have <code>addition</code> and <code>subtraction</code>.</p><p>Start by once again going to your <code>intentdefinition</code> file, click the &ldquo;+&rdquo; button the same way you created your first intent, and select &ldquo;New Enum&rdquo;. Name it &ldquo;Operation&rdquo;.</p><p>You can now add simple enum values that represent an addition and subtraction. It&rsquo;s not possible to remove the &ldquo;unknown&rdquo; case. Changing the &ldquo;Display Name&rdquo; will change the string shown to the user. The other options are more specific to Siri, so we will not be changing those at this time.</p><p>Adding addition and subtraction options will make the configuration look like this:</p><p><img src=/img/shortcut_enum_config.png alt="Shortcut Enum Configurations"></p><p>We will replace &ldquo;AddNumbers&rdquo; with &ldquo;OperateNumbers&rdquo;, so rename the intent accordingly. Feel free to change the title and description while you are at it.</p><p><img src=/img/shortcut_rename_add_to_operate.png alt="Renaming AddNumbers to OperateNumbers"></p><p>Next, we need to add a new parameter that represents the operation we want to do. Add a new parameter and change it&rsquo;s type to <code>Operation</code>, which is the operation we defined just now. Choose the default type to something other than <code>unknown</code>.</p><p><img src=/img/adding_operation_parameter.png alt="Adding the &ldquo;Operation&rdquo; Parameter"></p><p>Also change the &ldquo;Shortcuts app&rdquo; section to take into account the new parameter:</p><p><img src=/img/new_action_parameters_combinations.png alt="New Action Parameters Combinations"></p><p>If you try to build the project again, you will get a handful of errors. All of them are related to missing symbols. Remember how we mentioned that Xcode automatically generates a lot of protocols and classes based on your <code>intentdefinition</code> file? We have essentially deleted all the previous symbols the moment we chose to rename &ldquo;AddNumbers&rdquo; to &ldquo;OperateNumbers&rdquo;.</p><p>To solve this, you could rename all the &ldquo;AddNumbers-&rdquo; code to &ldquo;OperateNumbers-&rdquo;. Feel free to do that. I will create a new class and move the content over before deleting the original <code>AddNumbersIntentHandler.swift</code> file.</p><p>I implemented <code>OperateNumbersIntentHandler.swift</code> as such:</p><div class=highlight><pre tabindex=0 style=color:#cdd6f4;background-color:#1e1e2e;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-swift data-lang=swift><span style=display:flex><span><span style=color:#f38ba8>class</span> <span style=color:#f9e2af>OperateNumbersIntentHandler</span>: NSObject, OperateNumbersIntentHandling {
</span></span><span style=display:flex><span>  <span style=color:#f38ba8>func</span> <span style=color:#89b4fa>operate</span>(with operation: Operation, firstNumber: <span style=color:#89dceb>Int</span>, secondNumber: <span style=color:#89dceb>Int</span>) -&gt; <span style=color:#89dceb>Int</span> {
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>switch</span> operation {
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>case</span> .addition: <span style=color:#cba6f7>return</span> firstNumber <span style=color:#89dceb;font-weight:700>+</span> secondNumber
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>case</span> .subtraction: <span style=color:#cba6f7>return</span> firstNumber <span style=color:#89dceb;font-weight:700>-</span> secondNumber
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>default</span>: <span style=color:#89dceb>fatalError</span>(<span style=color:#a6e3a1>&#34;Invalid operation&#34;</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#f38ba8>func</span> <span style=color:#89b4fa>handle</span>(intent: OperateNumbersIntent, completion: @escaping (OperateNumbersIntentResponse) -&gt; <span style=color:#89dceb>Void</span>) {
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>opResult</span> = operate(with: intent.operation,
</span></span><span style=display:flex><span>                           firstNumber: intent.firstNumber!.intValue,
</span></span><span style=display:flex><span>                           secondNumber: intent.secondNumber!.intValue)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>result</span> = OperateNumbersIntentResponse.success(addition: NSNumber(value: opResult))
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    completion(result)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#f38ba8>func</span> <span style=color:#89b4fa>resolveSecondNumber</span>(<span style=color:#cba6f7>for</span> intent: OperateNumbersIntent, with completion: @escaping (OperateNumbersSecondNumberResolutionResult) -&gt; <span style=color:#89dceb>Void</span>) {
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>var</span> <span style=color:#f5e0dc>result</span>: OperateNumbersSecondNumberResolutionResult = .unsupported()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>defer</span> { completion(result) }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>if</span> <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>number</span> = intent.secondNumber?.intValue {
</span></span><span style=display:flex><span>      result = OperateNumbersSecondNumberResolutionResult.success(with: number)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#f38ba8>func</span> <span style=color:#89b4fa>resolveFirstNumber</span>(<span style=color:#cba6f7>for</span> intent: OperateNumbersIntent, with completion: @escaping (OperateNumbersFirstNumberResolutionResult) -&gt; <span style=color:#89dceb>Void</span>) {
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>var</span> <span style=color:#f5e0dc>result</span>: OperateNumbersFirstNumberResolutionResult = .unsupported()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>defer</span> { completion(result) }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>if</span> <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>number</span> = intent.firstNumber?.intValue {
</span></span><span style=display:flex><span>      result = OperateNumbersFirstNumberResolutionResult.success(with: number)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  <span style=color:#f38ba8>func</span> <span style=color:#89b4fa>resolveOperation</span>(<span style=color:#cba6f7>for</span> intent: OperateNumbersIntent, with completion: @escaping (OperationResolutionResult) -&gt; <span style=color:#89dceb>Void</span>) {
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>var</span> <span style=color:#f5e0dc>result</span>: OperationResolutionResult = .unsupported()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>defer</span> { completion(result) }
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#f38ba8>let</span> <span style=color:#f5e0dc>operation</span> = intent.operation
</span></span><span style=display:flex><span>    <span style=color:#cba6f7>if</span> operation <span style=color:#89dceb;font-weight:700>!=</span> .unknown {
</span></span><span style=display:flex><span>      result = .success(with: operation)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>Everything is essentially the same. The <code>resolveOperation</code> method will check to see that we have a valid operation, and if we don&rsquo;t, we tell the system that it&rsquo;s an unsupported parameter. We also added a new function that will do math based on the <code>operation</code> parameter.</p><p>Run the action again, and this time you have a way to choose an operation. Tapping on the operation will prompt you between <code>Addition</code> and <code>Subtraction</code>.</p><p><img src=/img/action_enum_type_param.png alt="Action Enum Type Paramater in Action"></p><h1 id=project-download>Project Download</h1><p>If you don&rsquo;t feel like following the steps above, you can download the completed project <a href=/archives/testshortcuts.zip>here</a> and explore it at your own pace.</p><h1 id=conclusion>Conclusion</h1><p>The Shortcuts app has received a very nice improvement with the introduction of Parameters on iOS 13. In this article we explored how you could implement them in your own apps, by creating a simple Action that allows users to pass in numbers to do some math operation on them. We saw how actions are exactly like functions - black boxes that take input and produce and output - and how developers can leverage them for their users.</p></article></div></main><footer><div class=container><div class=footer-navigation><a href=https://github.com/AndyIbanez><span class=inline-svg><svg viewBox="0 0 42 40" id="svg4" width="42" height="40"><path fill="currentColor" d="m14.20936 32.20794c0 .16542-.19024.29776-.4301.29776-.27295.0248-.46319-.10752-.46319-.29776.0-.16542.19024-.29776.4301-.29776.24814-.0248.46319.10752.46319.29776zm-2.57234-.3722c-.0579.16542.10753.35566.35566.40528.21505.0827.46319.0.51282-.16542.0496-.16542-.10753-.35566-.35566-.4301-.21505-.0579-.45492.0248-.51282.19024zm3.65586-.14061c-.23986.0579-.40529.21505-.38047.40528.0248.16543.23986.27295.488.21505.23986-.0579.40528-.21505.38047-.38047-.0248-.15715-.24813-.26468-.488-.23986zM20.73531-.19734273e-6C9.2632-.19734273e-6.48748 8.7095398.48748 20.18166c0 9.17273 5.77328 17.02207 14.01964 19.78464 1.05871.19024 1.43091-.46319 1.43091-1.00081.0-.51282-.0248-3.34156-.0248-5.0785.0.0-5.78982 1.24067-7.00568-2.46481.0.0-.94292-2.40691-2.29939-3.02725.0.0-1.8941-1.29857.13234-1.27376.0.0 2.05952.16542 3.19267 2.13396 1.81139 3.19267 4.84691 2.27457 6.02969 1.72868.19023-1.32339.72786-2.24149 1.32338-2.78739-4.62358-.51281-9.28852-1.18278-9.28852-9.13964.0-2.27458.62861-3.416 1.95199-4.87172-.21505-.53763-.9181-2.7543.21506-5.6161302 1.72867-.53762 5.7071 2.2332202 5.7071 2.2332202 1.65424-.46319 3.43254-.70305 5.1943-.70305 1.76176.0 3.54006.23986 5.1943.70305.0.0 3.97843-2.7791202 5.7071-2.2332202 1.13315 2.8701002.4301 5.0785002.21505 5.6161302 1.32339 1.46399 2.13397 2.60542 2.13397 4.87172.0 7.98168-4.87172 8.61856-9.49531 9.13964.76095.65342 1.4061 1.8941 1.4061 3.83782.0 2.78739-.0248 6.23647-.0248 6.9147.0.53763.38047 1.19105 1.43091 1.00082 8.27117-2.74603 13.87903-10.59537 13.87903-19.7681C41.51252 8.7095398 32.20745-.19734273e-6 20.73533-.19734273e-6zM8.52706 28.52727c-.10752.0827-.0827.27295.0579.4301.13234.13234.32258.19024.4301.0827.10753-.0827.0827-.27295-.0579-.4301-.13233-.13234-.32257-.19024-.4301-.0827zM7.63378 27.8573c-.0579.10753.0248.23987.19023.32258.13234.0827.29777.0579.35566-.0579C8.23757 28.01446 8.15487 27.88212 7.98944 27.7994 7.82401 27.7498 7.69168 27.7746 7.63378 27.8573zm2.67986 2.94454c-.13234.10753-.0827.35566.10752.51281.19024.19024.4301.21505.53763.0827.10752-.10752.0579-.35566-.10753-.51281-.18196-.19024-.4301-.21505-.53762-.0827zM9.37072 29.58598c-.13234.0827-.13234.29776.0.488.13234.19023.35566.27295.46319.19023.13234-.10752.13234-.32257.0-.51281-.1158-.19024-.33085-.27295-.46319-.16542z" id="path2" style="stroke-width:.08271171"/></svg>
</span></a><a href=https://x.com/AndyIbanezK><span class=inline-svg><svg viewBox="0 0 50 40" id="svg4" width="50" height="40"><path fill="currentColor" d="m44.56253 9.96871c.0313.43748.0313.87506.0313 1.31254C44.59383 24.62494 34.43764 40 15.87508 40 10.1563 40 4.84383 38.34368.37506 35.4688c.81253.0937 1.5937.12495 2.4375.12495 4.71867.0 9.06249-1.5937 12.53125-4.31245-4.43751-.0938-8.15627-3.00003-9.43754-7.00006.62505.0937 1.25001.15622 1.90632.15622.90622.0 1.81254-.12505 2.65624-.34369C5.84384 23.15619 2.37498 19.09373 2.37498 14.18748v-.12495c1.3437.75 2.90633 1.21875 4.56246 1.28117-2.71876-1.81253-4.49993-4.90624-4.49993-8.40627.0-1.87497.4999-3.59372 1.37496-5.09373 4.96877 6.125 12.43756 10.12493 20.81248 10.56251-.15622-.75001-.25-1.53118-.25-2.31245C24.37495 4.5312 28.87498.0 34.46871.0c2.90623.0 5.53121 1.21875 7.37501 3.1875 2.28118-.43748 4.46867-1.28127 6.40626-2.43749-.75011 2.3438-2.34381 4.31255-4.43751 5.56246 2.03127-.21864 4.00003-.78126 5.81247-1.56244-1.37477 1.99992-3.09362 3.7811-5.06237 5.21868z" id="path2" style="stroke-width:.09619153"/></svg>
</span></a><a href=https://www.linkedin.com/in/andyibanez/><span class=inline-svg><svg viewBox="0 0 41 40" id="svg4" width="41" height="40"><path fill="currentColor" d="M9.45332 40H1.16028V13.29405H9.45332zM5.30234 9.65111c-2.65185.0-4.80279-2.19648-4.80279-4.84832a4.80279 4.80279.0 019.60558.0c0 2.65184-2.15184 4.84832-4.80279 4.84832zM40.49152 40H32.21633V26.99971c0-3.09828-.0625-7.07159-4.3117-7.07159-4.3117.0-4.97243 3.36615-4.97243 6.84837V40H14.64808V13.29405h7.95375v3.64294h.11608c1.10716-2.09827 3.81169-4.3126 7.8466-4.3126 8.39304.0 9.93594 5.52691 9.93594 12.70564V40z" id="path2" style="stroke-width:.08928771"/></svg>
</span></a><a href=https://www.andyibanez.com/blog/index.xml><span class=inline-svg><svg viewBox="0 0 40 40" id="svg4" width="40" height="40"><path fill="currentColor" d="m11.435816 34.282008c0 3.15793-2.5599899 5.71793-5.7179299 5.71793s-5.717840022654-2.56-5.717840022654-5.71793c0-3.15794 2.559990022654-5.71793 5.717930022654-5.71793s5.7178399 2.56008 5.7178399 5.71793zm15.68388 4.21873C26.373806 24.697208 15.317496 13.626978 1.4992361 12.880288.68361608 12.836188.46077346e-4 13.491538.46077346e-4 14.308318v4.29186c0 .75134.579460002654 1.38142 1.329190022654 1.43017 9.9849699.65036 17.9886099 8.63408 18.6402999 18.6403.0488.74973.67893 1.3292 1.43018 1.3292h4.29186c.81687 9e-5 1.47223-.68348 1.42812-1.49911zm12.87933.0257C39.249566 17.649718 22.452206.754048 1.4735261.00092799867.66727608-.027972.46077346e-4.623338.46077346e-4 1.430038v4.29177c0 .77008.610270002654 1.39687 1.379730022654 1.42848 17.0694999.6999 30.7701699 14.40316 31.4699899 31.46999.0315.76946.6583 1.37972 1.42848 1.37972h4.29177c.8066-8e-5 1.45794-.66731 1.42901-1.47356z" id="path2" style="stroke-width:.08928544"/></svg>
</span></a><a href=https://www.andyibanez.com/curriculum/><span class=inline-svg><svg viewBox="0 0 15680 20480" id="svg4" width="35" height="40"><path fill="currentColor" d="M11655.83 12824.48 7840.0001 16640.464 4024.17 12824.48c-2859.863 123.906-5143.7701 2463.775-5143.7701 5352.003v384.005c0 1059.853 859.96601 1919.512 1919.92167 1919.512H14879.678c1059.956.0 1919.922-859.659 1919.922-1919.512v-384.005c0-2888.228-2283.906-5228.097-5143.77-5352.003zM-575.64445 3193.1279l256.0032 59.9048v2335.7732c-279.9651 167.9381-479.9548 459.7818-479.9548 812.0422.0 335.8762 183.9639 615.9437 443.96075 787.9778l-623.9822 2491.9352c-67.9944 275.9716 84.02025 559.6229 303.9782 559.6229H996.31762c219.95798.0 371.97268-283.6513 303.97828-559.6229L676.31362 7188.8259c259.99685-172.0341 443.96078-452.1016 443.96078-787.9778.0-352.2604-199.98973-644.1041-479.95483-812.0422V3484.9716l2639.90503 635.9119c-344.0171 688.1366-559.9814 1456.1463-559.9814 2279.9646.0 2827.8113 2291.8942 5119.5519 5119.7569 5119.5519 2827.8619.0 5119.7569-2291.7406 5119.7569-5119.5519.0-823.8183-211.971-1591.828-559.982-2279.9646l3851.824-927.7556c727.971-176.1302 727.971-1083.9175.0-1260.0477L8635.9653 92.929226c-519.9937-123.905551-1067.943-123.905551-1587.9367.0L-575.64445 1928.9841c-723.92585 176.1302-723.92585 1088.0136.0 1264.1438z" id="path2" style="stroke-width:39.99821472"/></svg>
</span></a><a href=https://www.andyibanez.com/contact-me><span class=inline-svg><svg viewBox="0 0 40 40" id="svg4" width="40" height="40"><path fill="currentColor" d="m39.99999 36.249999c0 2.0711-1.6789 3.75-3.74999 3.75H3.75c-2.07109.0-3.74999-1.6789-3.74999-3.75v-20.56843a3.7499996 3.7499996.0 011.43648-2.95125c1.94633-1.5257 3.55476-2.7628904 12.82812-9.4930404C15.57906 2.2789186 18.18727-.02709136 20 .00024864227 21.81234-.02745136 24.42156 2.2793086 25.73539 3.2371986c9.27242 6.72945 10.88304 7.9683604 12.82812 9.4931204a3.7499996 3.7499996.0 011.43648 2.95125zm-5.13015-15.35976c-.20024-.29125-.60156-.35898-.88586-.14898-1.78476 1.3182-4.33297 3.18008-8.24859 6.02179-1.31445.95828-3.92266 3.26414-5.73539 3.23672-1.81336.0269-4.41867-2.2768-5.73539-3.23672-3.91515-2.8414-6.46359-4.70343-8.24859-6.02179-.2843-.21-.68562-.14227-.88586.14898l-.70875 1.03094a.62484368.62484368.0 00.14367.8568c1.78805 1.32023 4.33235 3.1789 8.2268 6.00531 1.5839 1.15476 4.41593 3.73539 7.20812 3.71664 2.79094.0189 5.62195-2.56024 7.20804-3.71664 3.89453-2.82649 6.43891-4.68516 8.2268-6.00531a.62484368.62484368.0 00.14367-.8568z" id="path2" style="stroke-width:.07812498"/></svg></span></a></div></div><p class=made-with-love><a href=https://github.com/humrochagf/colordrop><b>Colordrop</b>
</a><span>theme | Made </span><span>by</span>
<a href=https://humberto.io/><b>Humberto Rocha</b></a></p></footer></div><script src=/copy/copy.js></script><script src=/search/elasticlunr.min.js></script><script src=/search/search.js></script><script>loadSearch()</script></body></html>